<h3 style="padding-bottom:6px; padding-left:20px; color:#ffffff; background-color:#E74C3C;">缓存击穿（缓存穿透）</h3>

![缓存穿透](https://i.loli.net/2019/02/19/5c6b968d1e946.png)

**缓存(Cache)** 是分布式、高并发的场景下，为了保护后端数据库，降低数据库的压力，引入的一种基于内存的数据访问机制，能加快数据的读取与写入，进而提高系统负载能力。

**缓存击穿(缓存穿透)** 是访问不存在缓存中的数据，进而直接访问数据库。



**缓存击穿** 和 **缓存穿透** 更为详细的分类:

| 名称     | 缓存是否存在被访问数据 | 数据库是否存在被访问数据 |
| -------- | ---------------------- | ------------------------ |
| 缓存击穿 | 否                     | 是                       |
|          | 否                     | 否                       |

在缓存穿透这种情形下，如果缓存和数据库都没有需要被访问的数据，那么访问缓存时没有数据则直接返回空，避免重复访问数据库，造成不必要的后端数据库压力。



总之，避免缓存击穿也好，避免缓存穿透也罢，核心思路是想法设法不要让请求怼在数据库上。



##### 解决方案

**1.缓存空值:** 如果第一次访问一个不存在的数据，那么将此key与value为空值的数据缓存起来，下次再有对应的key访问时，缓存直接返回空值，通常要设置key的过期时间，再次访问时更新过期时间;

**2.布隆过滤:** 类似散列集合(hash set)，判断key是否在这个集合中。实现机制在于比特位，一个key对应一个比特位，并且存储一个标识，如果key有对应的比特位，并且标识位表示存在，则表示有对应的数据。比如使用Redis 的 Bitmap实现。



---

<h3 style="padding-bottom:6px; padding-left:20px; color:#ffffff; background-color:#E74C3C;">缓存雪崩</h3>

**缓存雪崩:** 大量的缓存击穿意味着大量的请求怼在数据库上，轻者造成数据库响应巨慢，严重者造成数据库宕机。比如缓存内的数据集体定时刷新、服务器重启等。



##### 解决方案

1. 降低缓存刷新频率；
2. 部分缓存刷新，刷新数据时按照一定规则分组刷新；
3. 设置key永远不过期，如果需要刷新数据，则定时刷新；
4. 分片缓存，在分布式缓存下，将需要缓存的数据 散列 分布到多个节点，尽量将热点数据均匀分布到多节点。









